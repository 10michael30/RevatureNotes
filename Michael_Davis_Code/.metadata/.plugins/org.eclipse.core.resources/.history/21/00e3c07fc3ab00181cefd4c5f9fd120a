package com.ex.data;

import java.util.List;

import org.hibernate.Session;
import org.hibernate.Transaction;
import org.hibernate.query.Query;

import com.ex.models.User;

import com.ex.util.ConnectionUtil;

public class UserRepository {
public User findById(int id) {
	User b;
	try(Session session=ConnectionUtil.getSession();){
	 b=session.get(User.class, id);
	session.close();
	}
	return b;
	
}

public List<User> findAll(){
	
	List<User> users=null;
	
	//selecting what table to pull from and then parsing it to a class
	try(Session session=ConnectionUtil.getSession();){
	Query<User> q=session.createQuery("from User",User.class);
	
	//Query<Bear> q=session.createQuery("from Bear where furColor=r",Bear.class);

	users=q.getResultList();
	}
	return users;
	
}



public User save(User u) {
	
	Session session = ConnectionUtil.getSession();
	try {
		Transaction tx = session.beginTransaction(); //start of tx w db

		int id = (int) session.save(u);
		u.setId(id);

		tx.commit(); //assuming we have successfully added bear, commit tx
	}
	finally {
		session.close();
	}
	return u;
	
}


public User update(User u) {
	try(Session session=ConnectionUtil.getSession();){
		
	}
	}
}

public User findByUsername(String name) {
	User user=null;
	
	//selecting what table to pull from and then parsing it to a class
	try(Session session=ConnectionUtil.getSession();){
	Query<User> q=session.createQuery("from User where name like :param",User.class);
	q.setParameter("param",name);
	//Query<Bear> q=session.createQuery("from Bear where furColor=r",Bear.class);

	user=q.getSingleResult();
	}
	
	
	return user;
}
}
